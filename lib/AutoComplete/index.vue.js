"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const l=require("../_shared/utils/is.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const o=require("../_shared/utils/control.js"),t=require("../Select/index.js"),r=require("../Textarea/index.js"),a=require("../Input/index.js"),u=e.defineComponent({name:"AutoComplete",__name:"index",props:{modelValue:{default:void 0},defaultValue:{default:""},disabled:{type:Boolean,default:!1},data:{default:()=>[]},popupContainer:{default:void 0},strict:{type:Boolean,default:!1},filterOption:{type:Function,default:void 0},triggerProps:{default:()=>({})},allowClear:{type:Boolean,default:!0},vistualListProps:{},isSelectSetValue:{type:Boolean,default:!0},isSearch:{type:Boolean,default:!0},type:{default:"input"}},emits:["update:modelValue","change","search","select","clear","dropdown-scroll","dropdown-reach-bottom","blur","focus","input","keydown"],setup(u,{expose:n,emit:s}){const i=u,d=s,{modelValue:p,defaultValue:c,data:f,strict:v,isSelectSetValue:m,isSearch:g}=e.toRefs(i),{filterOption:y}=i,w=e.ref(),h=e.ref(),b=e.ref(!1),k=o(p,c.value,(e=>{d("update:modelValue",e)})),C=e.ref([]),S=async(o,t,r="")=>{switch(o){case"input":{d("input",r,t),d("search",r);const o=[...f.value];await e.nextTick(),JSON.stringify(o)==JSON.stringify(f.value)&&g.value?C.value=f.value.filter((e=>{const o=l.isObject(e)?e:{label:e,value:e};return(null==y?void 0:y(r,o))??((e,l)=>{const o=l.label,t=v.value?o:o.toLowerCase(),r=v.value?e:e.toLowerCase();return null==t?void 0:t.includes(r)})(r,o)})):C.value=f.value,b.value=!!C.value.length}break;case"select":b.value=!1,m.value&&(k.value=r),d("select",r);break;case"focus":b.value=!!C.value.length,d("focus",t);break;case"blur":b.value=!1,d("blur",t);break;case"clear":k.value="",d("clear",t)}};return n({focus(){var e;null==(e=w.value)||e.focus()},blur(){var e;null==(e=w.value)||e.blur()},getInputRef(){var e;return null==(e=w.value)?void 0:e.getInputRef()},getMirrorRef(){var e;return null==(e=w.value)?void 0:e.getMirrorRef()},updatePosition(e,l){var o,t;null==(t=null==(o=h.value)?void 0:o.getPopupRef())||t.updatePosition(e,l)}}),(l,o)=>(e.openBlock(),e.createBlock(e.unref(t.default),{"popup-visible":b.value,options:C.value,"popup-container":l.popupContainer,"trigger-props":l.triggerProps,"virtual-list-props":l.vistualListProps,"show-empty":!1,hotkeys:"",ref_key:"selectRef",ref:h,class:"yc-auto-complete",onDropdownScroll:o[14]||(o[14]=e=>l.$emit("dropdown-scroll",e)),onDropdownReachBottom:o[15]||(o[15]=e=>l.$emit("dropdown-reach-bottom",e)),onSelect:o[16]||(o[16]=e=>S("select",null,e))},e.createSlots({trigger:e.withCtx((()=>[e.renderSlot(l.$slots,"trigger",{},(()=>["input"==l.type?(e.openBlock(),e.createBlock(e.unref(a),e.mergeProps({key:0,modelValue:e.unref(k),"onUpdate:modelValue":o[0]||(o[0]=l=>e.isRef(k)?k.value=l:null),disabled:l.disabled,"allow-clear":l.allowClear},l.$attrs,{ref_key:"inputRef",ref:w,onInput:o[1]||(o[1]=(e,l)=>S("input",l,e)),onChange:o[2]||(o[2]=e=>l.$emit("change",e)),onClear:o[3]||(o[3]=e=>S("clear",e)),onKeydown:o[4]||(o[4]=e=>S("keydown",e)),onFocus:o[5]||(o[5]=e=>S("focus",e)),onBlur:o[6]||(o[6]=e=>S("blur",e))}),null,16,["modelValue","disabled","allow-clear"])):(e.openBlock(),e.createBlock(e.unref(r),e.mergeProps({key:1,modelValue:e.unref(k),"onUpdate:modelValue":o[7]||(o[7]=l=>e.isRef(k)?k.value=l:null),disabled:l.disabled,"allow-clear":l.allowClear,"enter-prevent":"","show-mirror":""},l.$attrs,{ref_key:"inputRef",ref:w,onInput:o[8]||(o[8]=(e,l)=>S("input",l,e)),onChange:o[9]||(o[9]=e=>l.$emit("change",e)),onClear:o[10]||(o[10]=e=>S("clear",e)),onKeydown:o[11]||(o[11]=e=>l.$emit("keydown",e)),onFocus:o[12]||(o[12]=e=>S("focus",e)),onBlur:o[13]||(o[13]=e=>S("blur",e))}),null,16,["modelValue","disabled","allow-clear"]))]))])),_:2},[l.$slots.option?{name:"option",fn:e.withCtx((o=>[e.renderSlot(l.$slots,"option",e.normalizeProps(e.guardReactiveProps(o)))])),key:"0"}:void 0,l.$slots.footer?{name:"footer",fn:e.withCtx((()=>[e.renderSlot(l.$slots,"footer")])),key:"1"}:void 0]),1032,["popup-visible","options","popup-container","trigger-props","virtual-list-props"]))}});module.exports=u;
