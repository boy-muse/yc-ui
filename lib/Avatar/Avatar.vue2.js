"use strict";const e=require("vue"),r=require("../node_modules/@vueuse/core/index.js");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const t=require("../_shared/utils/fn.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const a=require("../_shared/icons/IconImageClose.vue.js"),o=require("./hooks/useContext.js"),l={key:1,class:"yc-avatar-image"},s=["src"],i={key:1,class:"yc-avatar-image-icon"},n=e.defineComponent({name:"Avatar",__name:"Avatar",props:{shape:{default:void 0},imageUrl:{default:""},size:{default:void 0},autoFixFontSize:{type:Boolean,default:void 0},triggerType:{default:"button"},triggerIconStyle:{default:()=>({})},objectFit:{default:"cover"}},emits:["click","error","load"],setup(n,{emit:c}){const u=n,d=c,{size:m,autoFixFontSize:v,shape:y}=o().inject(u),f=e.ref(!1),g=e.ref(1),k=e.ref(),p=e.ref(),h=e.computed((()=>{var e;return null==(e=k.value)?void 0:e.querySelector("img")})),j=e=>{f.value=!0,d("error",e)};return v.value&&r.useResizeObserver(k,(()=>{const e=m.value??p.value.offsetWidth,r=e/(k.value.offsetWidth+8);g.value=e&&r<1?r:1})),(r,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["yc-avatar",`yc-avatar-shape-${e.unref(y)}`]),style:e.normalizeStyle({width:e.unref(t.valueToPx)(e.unref(m)),height:e.unref(t.valueToPx)(e.unref(m))}),ref_key:"avatarRef",ref:p,onClick:o[1]||(o[1]=e=>r.$emit("click",e))},[r.$slots.default?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass([h.value?"yc-avatar-image":"yc-avatar-text"]),style:e.normalizeStyle({transform:h.value?"":`scale(${g.value}) translateX(-50%)`}),ref_key:"textRef",ref:k},[e.renderSlot(r.$slots,"default",{},void 0,!0)],6)):r.imageUrl?(e.openBlock(),e.createElementBlock("span",l,[f.value?(e.openBlock(),e.createElementBlock("div",i,[e.createVNode(e.unref(a))])):(e.openBlock(),e.createElementBlock("img",{key:0,src:r.imageUrl,style:e.normalizeStyle({objectFit:r.objectFit}),alt:"avatar",onLoad:o[0]||(o[0]=e=>r.$emit("load",e)),onError:j},null,44,s))])):e.createCommentVNode("",!0),r.$slots["trigger-icon"]?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass([{"yc-avatar-trigger-icon-button":"button"==r.triggerType,"yc-avatar-trigger-icon-mask":"mask"==r.triggerType}]),style:e.normalizeStyle(r.triggerIconStyle)},[e.renderSlot(r.$slots,"trigger-icon",{},void 0,!0)],6)):e.createCommentVNode("",!0)],6))}});module.exports=n;
