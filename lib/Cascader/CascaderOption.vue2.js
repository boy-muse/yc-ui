"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const l=require("../_shared/utils/fn.js"),a=require("../_shared/utils/is.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const u=require("../_shared/icons/IconArrowRight.vue.js"),o=require("../_shared/icons/IconLoading.vue.js"),t=require("../Checkbox/index.js"),n=require("./hooks/useContext.js"),v=e.defineComponent({__name:"CascaderOption",props:{level:{default:-1},index:{default:-1},nodePath:{default:()=>[]},label:{default:""},value:{default:""},render:{type:Function,default:void 0},disabled:{type:Boolean,default:!1},tagProps:{default:()=>({})},children:{default:()=>[]},isLeaf:{type:Boolean,default:!1}},setup(v){const r=v,{label:i,value:d,disabled:s,level:c,isLeaf:m,children:p,nodePath:f}=e.toRefs(r),{totalOptions:h,computedValue:k,pathMode:y,curLevel:b,curPath:j,multiple:g,expandTrigger:x,expandChild:B,slots:q,getOption:C,getValueKey:_,blur:P,loadMore:O}=n.default().inject(),V=e.ref(!1),E=e.computed((()=>a.isFunction(O)?!V.value&&!m.value&&!p.value.length:p.value.length)),L=e.computed((()=>p.value.length?n.getLeafNodes(p.value):[C(d.value)])),N=e.computed((()=>!p.value.length)),w=e.computed((()=>{var e;if(!k.value)return!1;if(!g.value){return null==(e=(C(k.value)??{}).nodePath)?void 0:e.some((e=>_(e.value)==_(d.value)))}const l=k.value.map((e=>C(e)??{}));if(N.value)return l.some((e=>_(null==e?void 0:e.value)==_(d.value)));const a=Object.fromEntries(l.map((e=>[_(null==e?void 0:e.value),e])));return L.value.every((e=>a[_(e.value)]))})),F=e.computed((()=>{if(N.value||!g.value)return!1;const e=k.value.map((e=>C(e)??{})),l=Object.fromEntries(e.map((e=>[_(e.value),e])));return L.value.some((e=>l[_(e.value)]))})),I=e=>{var l,a,u,o,t;const n=k.value;if(e){const e=Object.fromEntries(n.map((e=>[_(e),e])));k.value=[...n,...L.value.map((e=>y.value?e.nodePath.map((e=>e.value)):e.value)).filter((l=>!e[_(l)]))],b.value=(null==(a=null==(l=L.value)?void 0:l[0])?void 0:a.level)??b.value,j.value=(null==(t=null==(o=null==(u=L.value)?void 0:u[0])?void 0:o.nodePath)?void 0:t.map((e=>e.index)))??j.value}else{const e=Object.fromEntries(L.value.map((e=>y.value?e.nodePath.map((e=>e.value)):e.value)).map((e=>[_(e),e])));k.value=n.filter((l=>!e[_(l)])),b.value=c.value,j.value=f.value.map((e=>e.index))}},M=async e=>{if(!s.value&&!V.value){if(E.value&&a.isFunction(O)&&x.value==e){V.value=!0;const e=n.findOptionByValueAndLevel(h.value,d.value,c.value);await new Promise((l=>{O(e,(a=>{e.children=(null==a?void 0:a.length)?a:[],l("")}))})),V.value=!1,await l.sleep(0)}N.value||x.value!=e||(b.value=B.value?L.value[0].level:c.value+1,j.value=B.value?L.value[0].nodePath.map((e=>e.index)):f.value.map((e=>e.index))),N.value&&"click"==e&&!g.value&&(k.value=y.value?f.value.map((e=>e.value)):d.value,P())}},A=()=>{var e;return(null==(e=q.option)?void 0:e.call(q,{data:r}))??i.value};return(l,a)=>(e.openBlock(),e.createElementBlock("li",{tabindex:"0",role:"menuitem",class:e.normalizeClass(["yc-cascader-option",{"yc-cascader-option-selected":w.value||F.value,"yc-cascader-option-disabled":e.unref(s)}])},[e.unref(g)?(e.openBlock(),e.createBlock(e.unref(t.default),{key:0,disabled:e.unref(s),"model-value":w.value,indeterminate:F.value,"onUpdate:modelValue":I},null,8,["disabled","model-value","indeterminate"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"yc-cascader-option-label text-ellipsis",onMouseenter:a[0]||(a[0]=e=>M("hover")),onClick:a[1]||(a[1]=e=>M("click"))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(A))),E.value?(e.openBlock(),e.createBlock(e.unref(u),{key:0})):e.createCommentVNode("",!0),V.value?(e.openBlock(),e.createBlock(e.unref(o),{key:1,color:"rgb(22,93,255)",spin:""})):e.createCommentVNode("",!0)],32)],2))}});module.exports=v;
