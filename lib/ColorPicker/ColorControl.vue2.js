"use strict";const e=require("vue"),a=require("../node_modules/@vueuse/core/index.js"),o=require("../_shared/utils/color.js");require("../_shared/utils/dom.js");const l=require("../_shared/utils/fn.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const r=e.defineComponent({__name:"ColorControl",props:{color:{},baseColor:{},popupVisible:{type:Boolean},disabled:{type:Boolean},hideTrigger:{type:Boolean},mode:{}},emits:["update:color","update:alpha","update:baseColor","change"],setup(r,{expose:t,emit:s}){const i=r,u=s,{color:n,mode:c,popupVisible:d,disabled:p,hideTrigger:v}=e.toRefs(i),m=e.ref(),f=e.ref(),g=e.ref({min:0,max:0}),h=new o.GradientColorCalculator,{x:b}=a.useDraggable(m,{disabled:p,onMove(){y()}}),C=e=>{const{max:a,min:l}=g.value;if("alpha"==c.value){const r=100*o.parseColor(e).getAlpha();b.value=l+r/100*(a-l),u("update:alpha",r)}else b.value=h.getPositionForColor(e,a-l)+l},y=()=>{const{min:e,max:a}=g.value;b.value=b.value<e?e:b.value,b.value=b.value>a?a:b.value;let l="";if("alpha"==c.value){const r=+((b.value-e)/(a-e)).toFixed(2);l=o.parseColor(n.value).setAlpha(r).toRgbString(),u("update:alpha",r)}else l=h.getColorAtPosition(b.value-e,a-e),u("update:baseColor",l),u("change",l);u("update:color",l)},x=e=>{p.value||(b.value=e.pageX,y())};return e.watch((()=>d.value),(async e=>{if(e||v.value){await l.sleep(0);const{left:e,right:a}=f.value.getBoundingClientRect();g.value={min:e,max:a},C(n.value)}}),{immediate:!0}),t({setPosition:C}),(a,o)=>(e.openBlock(),e.createElementBlock("div",{class:"yc-color-picker-control-bar",style:e.normalizeStyle({background:"alpha"==e.unref(c)?`linear-gradient(to right, rgba(0, 0, 0, 0), ${a.baseColor})`:""}),ref_key:"barRef",ref:f,onClick:x},[e.createElementVNode("div",{class:"yc-color-picker-control-bar-handler",style:e.normalizeStyle({color:e.unref(n),transform:`translate(calc(${e.unref(l.valueToPx)(e.unref(b)-g.value.min)} - 50%),-50%)`}),ref_key:"btnRef",ref:m},null,4)],4))}});module.exports=r;
