"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const o=require("../_shared/utils/is.js");require("../_shared/utils/time.js");const t=require("../_shared/utils/global-config.js"),a=require("../_shared/utils/control.js");require("../_shared/icons/_Icon.vue.js");const l=require("../_shared/icons/IconClose.vue.js"),r=require("../node_modules/@vueuse/core/index.js"),s=require("../Modal/hooks/useModalClose.js"),i=require("./ImagePreviewToolbar.vue.js"),n={class:"yc-image-preview-mask"},u={class:"yc-image-preview-wrapper"},c=["src"],d=e.defineComponent({name:"ImagePreview",inheritAttrs:!1,__name:"ImagePreview",props:{src:{default:""},visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},maskClosable:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},actionsLayout:{default:()=>["fullScreen","rotateRight","rotateLeft","zoomIn","zoomOut","originalSize"]},popupContainer:{default:void 0},escToClose:{type:Boolean,default:!0},wheelZoom:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},defaultScale:{default:1},zoomRate:{default:1.1}},emits:["update:visible","close"],setup(d,{emit:f}){const m=d,v=f,{visible:p,defaultVisible:w,maskClosable:y,escToClose:h,defaultScale:k,zoomRate:g,wheelZoom:b,keyboard:C,popupContainer:z}=e.toRefs(m),{zIndex:B,popupContainer:S}=t.getGlobalConfig(m),_=e.ref(),V=a(e.ref(),k.value),q=e.ref(0),{outerVisible:j,innerVisible:I,handleClose:L,handleAfterLeave:N}=s({visible:p,defaultVisible:w,escToClose:h,maskClosable:y,onBeforeOk:()=>!0,onBeforeCancel:()=>!0,emits:v}),A=e=>{switch(e){case"rotateRight":q.value+=90;break;case"rotateLeft":q.value-=90;break;case"zoomIn":V.value*=g.value;break;case"zoomOut":V.value/=g.value;break;case"originalSize":V.value=k.value,q.value=0;break;case"fullScreen":{const{offsetWidth:e,offsetHeight:o}=_.value;V.value=e>o?window.innerHeight/o:window.innerHeight/e}}};return(()=>{if(b.value&&r.useEventListener("wheel",(e=>{e.preventDefault();const o=e.deltaY<0?1:-1;V.value*=Math.pow(g.value,o)})),C.value){const e={ArrowUp:"zoomIn",ArrowDown:"zoomOut"," ":"originalSize"};r.onKeyStroke(["ArrowUp","ArrowDown"," "],(o=>{A(e[o.key])}))}})(),(t,a)=>(e.openBlock(),e.createBlock(e.Teleport,{to:e.unref(S)},[e.unref(j)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["yc-image-preview",t.$attrs.class,{"yc-image-preview-absolute":!e.unref(o.isUndefined)(e.unref(z))}]),style:e.normalizeStyle({zIndex:e.unref(B),...t.$attrs.style??{}})},[e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",n,null,512),[[e.vShow,e.unref(I)]])])),_:1}),e.createVNode(e.Transition,{name:"fade",onAfterLeave:e.unref(N)},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",u,[e.createElementVNode("div",{style:e.normalizeStyle({transform:`scale(${e.unref(V)}, ${e.unref(V)})`}),class:"yc-image-preview-img-container",onClick:a[0]||(a[0]=e.withModifiers((o=>e.unref(L)("mask",o)),["self"]))},[e.createElementVNode("img",{src:t.src,style:e.normalizeStyle({transform:`translate(-50%, -50%) rotate(${q.value}deg)`}),class:"yc-image-preview-img",ref_key:"imageRef",ref:_},null,12,c)],4),e.createVNode(i,{actionsLayout:t.actionsLayout,onClick:A},e.createSlots({_:2},[t.$slots.actions?{name:"actions",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"actions",{},void 0,!0)])),key:"0"}:void 0]),1032,["actionsLayout"]),e.renderSlot(t.$slots,"arrow",{},void 0,!0),t.closable?(e.openBlock(),e.createElementBlock("div",{key:0,class:"yc-image-preview-close-btn",onClick:a[1]||(a[1]=o=>e.unref(L)("closeBtn",o))},[e.createVNode(e.unref(l))])):e.createCommentVNode("",!0)],512),[[e.vShow,e.unref(I)]])])),_:3},8,["onAfterLeave"])],6)):e.createCommentVNode("",!0)],8,["to"]))}});module.exports=d;
