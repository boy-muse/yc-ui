"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const u=require("../_shared/utils/fn.js"),t=require("../_shared/utils/is.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const n=require("../_shared/utils/control.js"),l=require("./InputOperaBtn.vue.js"),r=require("../Input/index.js"),o={class:"yc-input-number-step"},a=e.defineComponent({name:"InputNumber",__name:"InputNumber",props:{modelValue:{default:void 0},defaultValue:{default:""},mode:{default:"embed"},precision:{default:0},step:{default:1},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},max:{default:1/0},min:{default:-1/0},placeholder:{default:""},hideButton:{type:Boolean,default:!1},size:{default:void 0},allowClear:{type:Boolean,default:!1},modelEvent:{default:"change"},formatter:{},parser:{},readonly:{type:Boolean,default:!1},inputAttrs:{default:()=>({})}},emits:["update:modelValue","input","change","focus","blur","clear","keydown","pressEnter"],setup(a,{expose:s,emit:i}){const d=a,m=i,{modelValue:f,defaultValue:p,step:c,min:v,max:x,disabled:y,hideButton:b,mode:h,modelEvent:$,precision:k}=e.toRefs(d),{formatter:C,parser:w}=d,z=e.ref(),_=n(f,p.value,(e=>{m("update:modelValue","change"==$.value?e:q(e,"number"))}),(e=>{const u=t.isString(e)?e:q(e,"string");return C&&t.isFunction(C)?C(u):u})),S=e.computed((()=>{var e,u;const t=(null==(u=null==(e=String(c.value).match(/\.(\d+)/))?void 0:e[1])?void 0:u.length)??0;return Math.max(t,k.value)})),g=e=>w&&t.isFunction(w)?w(e):e;function q(e,u){const n=t.isNumber(e)?e:+e,l=S.value?n.toFixed(S.value):n.toFixed(0);return"number"==u?+l:l}const B=e=>{var u;const t=+g(_.value);let n="minus"==e?t-c.value:t+c.value;n=n<v.value?v.value:n,n=n>x.value?x.value:n,_.value=q(n,"number"),null==(u=z.value)||u.focus()},V=(e,u)=>{if(m("blur"==e?"blur":"pressEnter",u),!_.value)return;let t=+g(_.value);t=t<v.value?v.value:t,t=t>x.value?x.value:t,_.value=q(t,"number")},j=(e,u)=>{var t;if(!e)return void(_.value=e);const n=g(e),l=!/^-?\d*\.?\d*$/.test(n),r=((null==(t=n.match(/\./g))?void 0:t.length)??0)>1,o=n.includes("-")&&"-"!=n[0];l||r||o||(_.value=n,m("input",n,u))},E=e=>{_.value="",m("clear",e)};return s({focus(){var e;null==(e=z.value)||e.focus()},blur(){var e;null==(e=z.value)||e.focus()}}),(t,n)=>(e.openBlock(),e.createBlock(e.unref(r),{"model-value":e.unref(_),"allow-clear":t.allowClear,disabled:e.unref(y),readonly:t.readonly,error:t.error,size:t.size,placeholder:t.placeholder,"input-attrs":t.inputAttrs,class:"yc-input-number",ref_key:"inputRef",ref:z,onInput:j,onChange:n[0]||(n[0]=async(n,l)=>{await e.unref(u.sleep)(0),t.$emit("change",+n,l)}),onClear:E,onFocus:n[1]||(n[1]=e=>t.$emit("focus",e)),onBlur:n[2]||(n[2]=e=>V("blur",e)),onKeydown:n[3]||(n[3]=e=>t.$emit("keydown",e)),onPressEnter:n[4]||(n[4]=e=>V("pressEnter",e))},e.createSlots({_:2},[t.$slots.prefix?{name:"prefix",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"prefix",{},void 0,!0)])),key:"0"}:void 0,t.$slots.suffix||!e.unref(b)&&"embed"==e.unref(h)?{name:"suffix",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"suffix",{},(()=>[e.createElementVNode("div",o,[e.createVNode(l,{type:"plus",mode:e.unref(h),"computed-value":e.unref(_),disabled:e.unref(y),min:e.unref(v),max:e.unref(x),size:t.size,onClick:B},e.createSlots({_:2},[t.$slots.minus?{name:"icon",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"plus",{},void 0,!0)])),key:"0"}:void 0]),1032,["mode","computed-value","disabled","min","max","size"]),e.createVNode(l,{type:"minus",mode:e.unref(h),"computed-value":e.unref(_),disabled:e.unref(y),min:e.unref(v),max:e.unref(x),size:t.size,onClick:B},e.createSlots({_:2},[t.$slots.plus?{name:"icon",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"minus",{},void 0,!0)])),key:"0"}:void 0]),1032,["mode","computed-value","disabled","min","max","size"])])]),!0)])),key:"1"}:void 0,t.$slots.prepend||!e.unref(b)&&"button"==e.unref(h)?{name:"prepend",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"prepend",{},(()=>[e.createVNode(l,{type:"minus",mode:e.unref(h),"computed-value":e.unref(_),disabled:e.unref(y),min:e.unref(v),max:e.unref(x),size:t.size,onClick:B},e.createSlots({_:2},[t.$slots.minus?{name:"icon",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"minus",{},void 0,!0)])),key:"0"}:void 0]),1032,["mode","computed-value","disabled","min","max","size"])]),!0)])),key:"2"}:void 0,t.$slots.append||!e.unref(b)&&"button"==e.unref(h)?{name:"append",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"append",{},(()=>[e.createVNode(l,{type:"plus",mode:e.unref(h),"computed-value":e.unref(_),disabled:e.unref(y),max:e.unref(x),min:e.unref(v),size:t.size,onClick:B},e.createSlots({_:2},[t.$slots.plus?{name:"icon",fn:e.withCtx((()=>[e.renderSlot(t.$slots,"plus",{},void 0,!0)])),key:"0"}:void 0]),1032,["mode","computed-value","disabled","max","min","size"])]),!0)])),key:"3"}:void 0]),1032,["model-value","allow-clear","disabled","readonly","error","size","placeholder","input-attrs"]))}});module.exports=a;
