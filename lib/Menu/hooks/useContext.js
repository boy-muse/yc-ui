"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue");require("../../node_modules/tinycolor2/esm/tinycolor.js"),require("../../_shared/utils/dom.js");const t=require("../../_shared/utils/fn.js"),r=require("../../_shared/utils/is.js");require("../../_shared/utils/time.js"),require("../../Empty/index.js"),require("../../_shared/icons/_Icon.vue.js");const o=require("../../_shared/utils/control.js");require("../index.js");const n=require("../../node_modules/nanoid/index.browser.js"),l=require("../../node_modules/@vueuse/core/index.js"),u=require("../SubMenu.vue.js"),s=require("../MenuItem.vue.js"),i="menu-context";function d(t,o){const l=[],s=(t,i=null,d=0)=>{var a,c,p;if(!t)return;const f=Array.isArray(t)?t:[t];for(const m of f){if(!e.isVNode(m))continue;const t=n.nanoid(8),f=null==(a=m.type)?void 0:a.name,h=f===u.name,v=m.props,y=m.children,g=null==(c=m.component)?void 0:c.subTree,x=h?t:i,j=h?d+1:d;if(o.includes(f)&&l.push({id:t,type:h?"submenu":"menuitem",label:()=>{var e,t;return h?(null==(e=y.title)?void 0:e.call(y))||v.title:null==(t=y.default)?void 0:t.call(y)},path:v.path,parentId:i,level:d}),g)s(g);else if(Array.isArray(y))s(y,x,j);else if(r.isObject(y))for(const e of Object.keys(y))r.isFunction(y[e])&&s((null==(p=y[e])?void 0:p.call(y))||[],x,j)}};return s(t),l}function a(e){const t=new Map,r=[];return e.forEach((e=>{t.set(e.id,{...e,children:[]})})),t.forEach((e=>{if(null===e.parentId)r.push(e);else{const r=t.get(e.parentId);r&&r.children.push(e)}})),r}const c=e=>r.isUndefined(e)||r.isBoolean(e)&&e?167:r.isNumber(e)?e:void 0;exports.FlattenMenuTree=d,exports.buildMenuTree=a,exports.default=()=>({provide:(r,n,p)=>{const{selectedKeys:f,defaultSelectedKeys:m,openKeys:h,defaultOpenKeys:v,levelIndent:y,collapsed:g,defaultCollapsed:x,breakpoint:j,accordion:b,autoOpen:q,triggerProps:I,tooltipProps:O,autoOpenSelected:S,mode:M,theme:_,autoScrollIntoView:K,scrollConfig:T,collapsedWidth:P,popupMaxHeight:C}=e.toRefs(r),w=o(f,m.value,(e=>{n("update:selectedKeys",e)})),A=o(g,x.value,(e=>{W.value=[],n("update:collapsed",e)})),W=o(h,v.value,(e=>{n("update:openKeys",e)})),k=e.computed((()=>c(C.value))),H=e.useSlots(),N=e.computed((()=>{var e;return d((null==(e=H.default)?void 0:e.call(H))||[],[u.name,s.name])})),V=e.ref([]),E=e.computed((()=>a(N.value))),z=e.ref(1e6);return"horizontal"==M.value&&l.useResizeObserver(p,t.throttle((()=>{const e=p.value.offsetWidth-52;let t=0,r=0;for(let o=0;o<E.value.length;o++){const n=r+(o>0?4:0)+V.value[o];if(n>e)break;r=n,t++}z.value=t}),200)),e.provide(i,{computedSelectedKeys:w,computedOpenKeys:W,computedCollapsed:A,levelIndent:y,accordion:b,autoOpen:q,triggerProps:I,tooltipProps:O,mode:M,autoOpenSelected:S,popupMaxHeight:k,autoScrollIntoView:K,scrollConfig:T,theme:_,menuTreeNodes:N,menuTree:E,max:z,menuItemWidths:V,emits:n}),{computedCollapsed:A,breakpoint:j,collapsedWidth:e.computed((()=>t.valueToPx(P.value))),menuTree:E,max:z}},inject:()=>e.inject(i,{computedSelectedKeys:e.ref(""),computedOpenKeys:e.ref([]),levelIndent:e.ref(20),computedCollapsed:e.ref(!1),accordion:e.ref(!1),autoOpen:e.ref(!1),tooltipProps:e.ref({}),triggerProps:e.ref({}),autoOpenSelected:e.ref(!1),mode:e.ref("vertical"),theme:e.ref("light"),popupMaxHeight:e.ref(),autoScrollIntoView:e.ref(!1),scrollConfig:e.ref({}),menuTreeNodes:e.ref([]),menuTree:e.ref([]),max:e.ref(1e4),menuItemWidths:e.ref([]),emits:()=>{}})}),exports.getPopupMaxHeight=c,exports.isMenuItemActive=function(e,t,r){if(t===r)return!0;const o=(e,t)=>{for(const r of e){if(r.path===t)return r;if(r.children&&r.children.length>0){const e=o(r.children,t);if(e)return e}}return null},n=o(e,t);if(!n)return!1;const l=(e,t)=>e.path===t||!!e.children&&e.children.some((e=>l(e,t)));return l(n,r)};
