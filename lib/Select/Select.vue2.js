"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const l=require("../_shared/utils/fn.js"),a=require("../_shared/utils/is.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const o=require("./hooks/useContext.js"),t=require("./SelectIcon.vue.js"),r=require("./SelectView.vue.js"),u=require("../Input/index.js"),n=require("../InputTag/index.js"),s=require("../Trigger/index.js"),i=e.defineComponent({name:"Select",__name:"Select",props:{multiple:{type:Boolean,default:!1},modelValue:{type:[String,Number,Boolean,Object,Array],default:void 0},defaultValue:{type:[String,Number,Boolean,Object,Array],default:e=>e.multiple?[]:""},inputValue:{default:void 0},defaultInputValue:{default:""},size:{default:void 0},placeholder:{default:""},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},allowSearch:{type:Boolean,default:e=>e.multiple},allowCreate:{type:Boolean,default:!1},maxTagCount:{default:0},popupContainer:{default:void 0},bordered:{type:Boolean,default:!0},defaultActivefirstOption:{type:Boolean,default:!1},popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},unmountonClose:{type:Boolean},filterOption:{type:[Boolean,Function],default:void 0},options:{default:()=>[]},virtualListProps:{default:void 0},triggerProps:{default:()=>({contentStyle:{}})},formatLabel:{},fallbackOption:{},showExtraOptions:{type:Boolean,default:!0},valueKey:{default:""},searchDelay:{default:500},limit:{default:0},fieldNames:{default:()=>({})},scrollbar:{type:Boolean,default:!0},showHeaderOnEmpty:{type:Boolean,default:!1},showFooterOnEmpty:{type:Boolean,default:!1},tagNowrap:{type:Boolean,default:!1},hotkeys:{type:Boolean},showEmpty:{type:Boolean,default:!0}},emits:["update:modelValue","update:inputValue","update:popupVisible","change","input-value-change","clear","remove","search","exceedLimit","popup-visible-change","dropdown-scroll","dropdown-reach-bottom","select"],setup(i,{expose:p,emit:d}){const c=i,f=d,{allowClear:v,disabled:m,loading:h,searchDelay:y,showFooterOnEmpty:b,showHeaderOnEmpty:w,multiple:g,allowSearch:B,allowCreate:V,virtualListProps:C}=e.toRefs(c),k=e.ref(),x=e.ref(),{computedVisible:j,computedValue:S,computedInputValue:_,selectOptions:q,createOptions:O}=o().provide(c,f,k),E=e.computed((()=>{const e=g.value?S.value.length:String(S.value).length;return v.value&&!m.value&&!h.value&&!!e})),N=e.computed((()=>(!B.value||h.value)&&!V.value&&a.isUndefined(c.filterOption))),z=async(e,a="")=>{var o,t,r;switch(e){case"create":if(!V.value)return;if(O.value.find((e=>e==_.value)))return;O.value.push({label:_.value,value:_.value}),B.value&&(null==(o=k.value)||o.blur());break;case"clear":S.value=g.value?[]:"",f("clear");break;case"search":await l.sleep(y.value),f("search",a);break;case"focus":if(m.value)return;if(j.value)return null==(t=k.value)?void 0:t.blur();j.value=!0,await l.sleep(0),null==(r=k.value)||r.focus();break;case"blur":j.value=!1;break;case"updateValue":S.value=a.map((e=>e.value))}};return p({focus(){var e;null==(e=k.value)||e.focus()},blur(){var e;null==(e=k.value)||e.blur()},getPopupRef:()=>x.value}),(l,a)=>(e.openBlock(),e.createBlock(e.unref(s),e.mergeProps({"popup-visible":e.unref(j),"onUpdate:popupVisible":a[14]||(a[14]=l=>e.isRef(j)?j.value=l:null),"unmount-on-close":l.unmountonClose,"popup-container":l.popupContainer,disabled:e.unref(m),"popup-offset":4,trigger:"focus",position:"bl","animation-name":"slide-dynamic-origin","need-transform-origin":"","auto-fit-popup-width":"","prevent-focus":"",ref_key:"popupRef",ref:x},l.triggerProps),{content:e.withCtx((()=>[e.createVNode(r,{loading:e.unref(h),scrollbar:l.scrollbar,"virtual-list-props":e.unref(C),"show-footer-on-empty":e.unref(b),"show-header-on-empty":e.unref(w)},null,8,["loading","scrollbar","virtual-list-props","show-footer-on-empty","show-header-on-empty"])])),default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["yc-select",{"yc-select-allow-search":e.unref(B),"yc-select-allow-clear":E.value,"yc-select-no-border":!l.bordered},l.$attrs.class]),style:e.normalizeStyle(l.$attrs.style)},[e.renderSlot(l.$slots,"trigger",{},(()=>{var o;return[e.unref(g)?(e.openBlock(),e.createBlock(e.unref(n),{key:1,"input-value":e.unref(_),"onUpdate:inputValue":a[7]||(a[7]=l=>e.isRef(_)?_.value=l:null),"model-value":e.unref(q),placeholder:l.placeholder,readonly:N.value,disabled:e.unref(m),size:l.size,error:l.error,"max-tag-count":l.maxTagCount,"tag-nowrap":l.tagNowrap,ref_key:"inputRef",ref:k,onFocus:a[8]||(a[8]=e=>z("focus")),onBlur:a[9]||(a[9]=e=>z("blur")),onInput:a[10]||(a[10]=e=>z("search",e)),onRemove:a[11]||(a[11]=(e,a)=>l.$emit("remove",e,a)),onPressEnter:a[12]||(a[12]=e=>z("create")),"onUpdate:modelValue":a[13]||(a[13]=e=>z("updateValue",e))},{tag:e.withCtx((({tag:a})=>[l.$slots.label?e.renderSlot(l.$slots,"label",{key:0,data:a},void 0,!0):e.createCommentVNode("",!0)])),suffix:e.withCtx((()=>[e.createVNode(t,{"popup-visible":e.unref(j),"allow-search":e.unref(B),loading:e.unref(h),"show-clear-btn":E.value,onClear:a[6]||(a[6]=e=>z("clear"))},null,8,["popup-visible","allow-search","loading","show-clear-btn"])])),_:3},8,["input-value","model-value","placeholder","readonly","disabled","size","error","max-tag-count","tag-nowrap"])):(e.openBlock(),e.createBlock(e.unref(u),{key:0,modelValue:e.unref(_),"onUpdate:modelValue":a[1]||(a[1]=l=>e.isRef(_)?_.value=l:null),"show-input":e.unref(j),readonly:N.value,disabled:e.unref(m),size:l.size,error:l.error,placeholder:(null==(o=e.unref(q)[0])?void 0:o.label)||"",ref_key:"inputRef",ref:k,onClick:a[2]||(a[2]=e=>z("focus")),onBlur:a[3]||(a[3]=e=>z("blur")),onInput:a[4]||(a[4]=e=>z("search",e)),onPressEnter:a[5]||(a[5]=e=>z("create"))},{label:e.withCtx((()=>[e.renderSlot(l.$slots,"label",{data:e.unref(q)[0]},(()=>{var a;return[e.createElementVNode("span",{class:e.normalizeClass([{"yc-input-placeholder":!e.unref(q).length}])},e.toDisplayString((null==(a=e.unref(q)[0])?void 0:a.label)||l.placeholder),3)]}),!0)])),suffix:e.withCtx((()=>[e.createVNode(t,{"popup-visible":e.unref(j),"allow-search":e.unref(B),loading:e.unref(h),"show-clear-btn":E.value,onClear:a[0]||(a[0]=e=>z("clear"))},null,8,["popup-visible","allow-search","loading","show-clear-btn"])])),_:3},8,["modelValue","show-input","readonly","disabled","size","error","placeholder"]))]}),!0)],6)])),_:3},16,["popup-visible","unmount-on-close","popup-container","disabled"]))}});module.exports=i;
