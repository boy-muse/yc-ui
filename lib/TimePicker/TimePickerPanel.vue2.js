"use strict";const e=require("vue"),l=require("../node_modules/b-tween/dist/b-tween.es.js"),t=require("../node_modules/dayjs/dayjs.min.js");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const r=require("../_shared/utils/fn.js"),o=require("../_shared/utils/is.js");require("../_shared/utils/time.js"),require("../Empty/index.js"),require("../_shared/icons/_Icon.vue.js");const u=require("./hooks/useContext.js"),i=require("../Button/index.js"),a=require("../Scrollbar/index.js"),n={class:"yc-timepicker-container"},s={class:"yc-timepicker"},c=["onClick"],d={class:"yc-timepicker-cell-inner"},m={key:0,class:"yc-timepicker-footer-extra-wrapper"},v={key:1,class:"yc-timepicker-footer-btn-wrapper"},p=e.defineComponent({__name:"TimePickerPanel",setup(p,{expose:f}){const{timeColumn:k,timeColumnCells:y,curValue:h,format:C,computedValue:b,computedVisible:j,disableConfirm:q,hideDisabledOptions:x,curIndex:B,inputRefs:_,disabledHours:g,disabledMinutes:w,disabledSeconds:E}=u().inject(),V=e.ref([]),N=e.computed((()=>!h.value.length||h.value.some((e=>!`${e}`)))),S=(e,l)=>{var t,r,o;return"hour"==l?null==(t=null==g?void 0:g())?void 0:t.includes(e):"minute"==l?null==(r=null==w?void 0:w(...h.value))?void 0:r.includes(e):null==(o=null==E?void 0:E(...h.value))?void 0:o.includes(e)},T=(e,t,r)=>{h.value[t]=e,k.value.forEach(((e,l)=>{h.value[l]=o.isUndefined(h.value[l])?0:h.value[l]}));const u=V.value[t].getScrollRef();new l({from:{scroll:u.scrollTop},to:{scroll:r.offsetTop},duration:300,easing:"quadOut",onUpdate:e=>{u.scrollTo({top:e.scroll,behavior:"instant"})}}).start(),q.value&&z()},D=e=>{const l=V.value.map((e=>e.getScrollRef().querySelectorAll(".yc-timepicker-cell")));k.value.map(((t,r)=>{const o=e[t];T(o,r,Array.from(l[r])[o])}))},z=()=>{var e;let l=t();k.value.forEach(((e,t)=>{l=l.set(e,h.value[t])}));const r=l.format(C.value);if(o.isArray(b.value)){if(b.value[B.value]=r,q.value)return;if(B.value||b.value[B.value+1])return j.value=!1;B.value++,null==(e=_.value[B.value])||e.focus(),h.value=[]}else j.value=!1,b.value=r};return f({async scroll(e){if(!j.value||!e)return;await r.sleep(0);const l=t(e,C.value),o={hour:l.hour(),minute:l.minute(),second:l.second()};h.value=k.value.map((e=>o[e])),D(o)}}),(l,t)=>(e.openBlock(),e.createElementBlock("div",n,[e.createElementVNode("div",s,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(y),((l,t)=>(e.openBlock(),e.createElementBlock("div",{key:t,class:"yc-timepicker-column"},[e.createVNode(e.unref(a),{"outer-style":{height:"100%"},style:{height:"100%",overflow:"auto"},ref_for:!0,ref:e=>V.value[t]=e},{default:e.withCtx((()=>[e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.cells,(r=>e.withDirectives((e.openBlock(),e.createElementBlock("li",{key:r.value,class:e.normalizeClass(["yc-timepicker-cell",{"yc-timepicker-cell-selected":r.value==e.unref(h)[t],"yc-timepicker-cell-disabled":S(r.value,l.unit)}]),onClick:e=>!S(r.value,l.unit)&&T(r.value,t,e.target)},[e.createElementVNode("div",d,e.toDisplayString(r.label),1)],10,c)),[[e.vShow,!e.unref(x)||!S(r.value,l.unit)]]))),128))])])),_:2},1536)])))),128))]),l.$slots.extra?(e.openBlock(),e.createElementBlock("div",m,[e.renderSlot(l.$slots,"extra",{},void 0,!0)])):e.createCommentVNode("",!0),e.unref(q)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",v,[e.createVNode(e.unref(i.default),{size:"mini",onClick:t[0]||(t[0]=()=>{const e=new Date;D({hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()})})},{default:e.withCtx((()=>t[1]||(t[1]=[e.createTextVNode("此刻")]))),_:1}),e.createVNode(e.unref(i.default),{type:"primary",size:"mini",disabled:N.value,onClick:z},{default:e.withCtx((()=>t[2]||(t[2]=[e.createTextVNode(" 确定 ")]))),_:1},8,["disabled"])]))]))}});module.exports=p;
