"use strict";const e=require("vue");require("../node_modules/tinycolor2/esm/tinycolor.js"),require("../_shared/utils/dom.js");const l=require("../_shared/utils/fn.js"),r=require("../_shared/utils/is.js");require("../_shared/utils/time.js");const n=require("../_shared/utils/vue-utils.js"),o=require("../_shared/utils/global-config.js"),a=require("../_shared/utils/control.js"),t=require("../node_modules/nanoid/index.browser.js"),i=require("../Input/index.js"),u=e.defineComponent({name:"VerificationCode",__name:"index",props:{modelValue:{default:void 0},defaultValue:{default:""},length:{default:6},size:{default:void 0},disabled:{type:Boolean,default:!1},masked:{type:Boolean},readonly:{type:Boolean,default:!1},error:{type:Boolean,default:!1},separator:{},formatter:{}},emits:["update:modelValue","input","change","finish"],setup(u,{emit:s}){const d=u,c=s,{modelValue:v,defaultValue:f,length:m}=e.toRefs(d),{formatter:p}=d,{size:y}=o.getGlobalConfig(d),g=a(v,f.value,(e=>{e.length==m.value&&c("finish",e),c("update:modelValue",e)})),h=e.computed((()=>new Array(m.value).fill("").map((()=>t.nanoid())))),b=e.ref([]),k=e.computed((()=>{const e=[...g.value];for(let l=e.length;l<m.value;l++)e[l]="";return e.map(((e,l)=>{const n=null==p?void 0:p(e,l,b.value.join(""));return e&&(r.isNumber(n)||r.isString(n))?n:e}))})),j=e.ref([]),B=e=>{for(let l=1;l<e;l++)if(!k.value[l])return!1;return!0};return(o,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["yc-verification-code",`yc-verification-code-size-${e.unref(y)}`])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,((t,u)=>{var s;return e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[e.createVNode(e.unref(i),{"model-value":k.value[u],size:e.unref(y),disabled:o.disabled,error:o.error,"invisible-button":!1,visibility:o.masked,readonly:o.readonly||!B(u),class:e.normalizeClass([{"yc-input-disabled-write":!B(u)}]),ref_for:!0,ref:e=>j.value[u]=e,onClick:e=>(async e=>{var r;if(B(e))return;const n=k.value.findIndex((e=>!e));await l.sleep(0),null==(r=j.value[n])||r.focus()})(u),onMousedown:e=>((e,l)=>{B(l)||e.preventDefault()})(e,u),onInput:(e,n)=>(async(e,n,o)=>{const a=e?e.at(e.length-1):" ",t=null==p?void 0:p(a,o,b.value.join(""));(!r.isFunction(p)||r.isNumber(t)||r.isString(t))&&(c("input",a,n,o),g.value=g.value.slice(0,o)+a+g.value.slice(o+1),e&&!k.value[o+1]&&o<m.value-1&&(j.value[o].blur(),await l.sleep(0),j.value[o+1].focus()))})(e,n,u),onChange:a[0]||(a[0]=l=>o.$emit("change",e.unref(g)))},null,8,["model-value","size","disabled","error","visibility","readonly","class","onClick","onMousedown","onInput"]),(null==(s=o.separator)?void 0:s.call(o,u,k.value[u]))?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(n.getSlotFunction)(o.separator(u,k.value[u]))),{key:0})):e.createCommentVNode("",!0)],64)})),128))],2))}});module.exports=u;
